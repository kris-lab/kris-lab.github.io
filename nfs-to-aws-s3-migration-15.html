<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>NFS to AWS S3 migration - Chris Stasiak</title><meta name="description" content="My DevOps team decision to drop NFS took a while. The biggest problem was that we could not isolate issues&hellip;"><meta name="generator" content="Publii Open-Source CMS for Static Site"><link rel="canonical" href="https://blog.kris-lab.com/nfs-to-aws-s3-migration-15.html"><link rel="alternate" type="application/atom+xml" href="https://blog.kris-lab.com/feed.xml"><link rel="alternate" type="application/json" href="https://blog.kris-lab.com/feed.json"><meta property="og:title" content="NFS to AWS S3 migration"><meta property="og:site_name" content="Chris Stasiak"><meta property="og:description" content="My DevOps team decision to drop NFS took a while. The biggest problem was that we could not isolate issues&hellip;"><meta property="og:url" content="https://blog.kris-lab.com/nfs-to-aws-s3-migration-15.html"><meta property="og:type" content="article"><style>:root{--body-font:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Fira Sans","Droid Sans","Helvetica Neue",Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol";--heading-font:var(--body-font);--logo-font:var(--body-font);--menu-font:var(--body-font)}</style><link rel="stylesheet" href="https://blog.kris-lab.com/assets/css/style.css?v=1e8049a2db15bde18056c70a364c486d"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.kris-lab.com/nfs-to-aws-s3-migration-15.html"},"headline":"NFS to AWS S3 migration","datePublished":"2014-04-24T07:41","dateModified":"2020-08-26T09:47","description":"My DevOps team decision to drop NFS took a while. The biggest problem was that we could not isolate issues&hellip;","author":{"@type":"Person","name":"Chris Stasiak"},"publisher":{"@type":"Organization","name":"Chris Stasiak"}}</script></head><body><header class="header" id="js-header"><a href="https://blog.kris-lab.com/" class="logo">Chris Stasiak</a><nav class="navbar js-navbar"><button class="navbar__toggle js-toggle" aria-label="Menu"><span class="navbar__toggle-box"><span class="navbar__toggle-inner">[MISSING TRANSLATION]</span></span></button><ul class="navbar__menu"><li class="home-button"><a href="https://blog.kris-lab.com" target="_self">{ home }</a></li><li class="has-submenu"><a href="https://blog.kris-lab.com/" target="_self" aria-haspopup="true">#tagged</a><ul class="navbar__submenu level-2" aria-hidden="true"><li><a href="https://blog.kris-lab.com/news/" target="_self">News</a></li><li><a href="https://blog.kris-lab.com/devops-2/" target="_self">DevOps</a></li><li><a href="https://blog.kris-lab.com/ffmpeg/" target="_self">Media</a></li><li><a href="https://blog.kris-lab.com/vr/" target="_self">360/3D/VR</a></li><li><a href="https://blog.kris-lab.com/artificial-intelligence-2/" target="_self">AI/ML/TPU</a></li></ul></li><li><a href="https://github.com/kris-lab" target="_blank">GitHub</a></li><li><a href="https://www.linkedin.com/in/krzysztof-chris-stasiak-6261244b/" target="_blank">LinkedIn</a></li><li><a href="https://keybase.io/krislab" target="_blank">Keybase</a></li><li><a href="https://twitter.com/_krislab" target="_blank">Twitter</a></li><li><a href="https://blog.kris-lab.com/contact.html" target="_self">Contact</a></li></ul></nav><div class="search"><div class="search__overlay js-search-overlay"><form action="https://blog.kris-lab.com/search.html" class="search__form"><input class="search__input js-search-input" type="search" name="q" aria-label="Search text" placeholder="search..." autofocus="autofocus"> <button class="search__submit">Search</button></form></div><button class="search__btn js-search-btn" aria-label="Search"><svg role="presentation" focusable="false" height="18" width="18"><use xlink:href="https://blog.kris-lab.com/assets/svg/svg-map.svg#search"/></svg></button></div></header><main><div class="wrapper"><article class="post"><header class="post__header"><a href="https://blog.kris-lab.com/devops-2/" class="post__maintag">devops</a><h1 class="post__title">NFS to AWS S3 migration</h1><div class="post__meta"><div class="post__author">By <a href="https://blog.kris-lab.com/authors/chris-stasiak/" class="invert" rel="author" title="Chris Stasiak">Chris Stasiak</a></div><time datetime="2014-04-24T07:41">April 24, 2014</time><div class="post__comments"><svg aria-hidden="true"><title>Comments</title><use xlink:href="https://blog.kris-lab.com/assets/svg/svg-map.svg#comments"/></svg> <a href="https://blog.kris-lab.com/nfs-to-aws-s3-migration-15.html#comments" data-disqus-identifier="867" class="invert" rel="nofollow">0</a></div></div></header><div class="post__inner"><div class="post__entry"><p>My DevOps team decision to drop NFS took a while. The biggest problem was that we could not isolate issues with NFS server when we reached some level of application load. NFS was the main data storage for photos, videos, streams etc. The problem was with scaling this solution. It was central point of tens of our services and if it fails the production was basically stopped. Yeah, to risky to extend and stick to this solution forever if we experienced bugs which we can not isolate on source code level!</p><p>We had a few choices. Build own API service as file storage provider? or look for external provider. It is worth to mention that we used AWS CloudFront as CDN for a very long time. So finally the choice was AWS S3. It stores files, distribute content internally and handle backups. Also important aspect was that we wanna finally switch our bare metal solution to cloud only.</p><p>It was real challenge to refactor all our service to switch to S3 without any troubles and production downtime. There is always a lot of aspects to consider before you will start. Important is at least backup, restore, latency of network between data centers (application to AWS).</p><p>As result we had to:</p><ul><li>Upgrade CM Framework to operate on more <a href="https://github.com/cargomedia/CM/pull/1194" target="_blank" rel="noopener">abstract file system providers</a></li><li>Introduce <a href="https://github.com/cargomedia/CM/pull/1197" target="_blank" rel="noopener">S3 (AWS SDK) layer</a> for our framework</li><li>Adjust <a href="https://github.com/cargomedia/CM-wowza" target="_blank" rel="noopener">Wowza</a> (Media Streaming engine) services to work more closely to <a href="https://github.com/cargomedia/CM-wowza/pull/4" target="_blank" rel="noopener">application</a> (CM Framework)</li><li>and many more (private repos)</li></ul><p>Pleas have a look on our puppet implementation of:</p><ul><li><a href="https://github.com/cargomedia/puppet-packages/tree/master/modules/nfs" target="_blank" rel="noopener">NFS</a></li></ul></div><footer><p class="post__last-updated">This article was updated on August 26, 2020</p><div class="post__tags-share"><ul class="post__tag"><li><a href="https://blog.kris-lab.com/aws/">AWS</a></li><li><a href="https://blog.kris-lab.com/cdn/">CDN</a></li><li><a href="https://blog.kris-lab.com/cloud-2/">cloud</a></li><li><a href="https://blog.kris-lab.com/devops-2/">devops</a></li><li><a href="https://blog.kris-lab.com/nfs/">NFS</a></li><li><a href="https://blog.kris-lab.com/roa/">ROA</a></li><li><a href="https://blog.kris-lab.com/storage/">storage</a></li><li><a href="https://blog.kris-lab.com/tools/">tools</a></li></ul><aside class="post__share"><a href="https://twitter.com/share?url=https%3A%2F%2Fblog.kris-lab.com%2Fnfs-to-aws-s3-migration-15.html&amp;via=%40_krislab&amp;text=NFS%20to%20AWS%20S3%20migration" class="js-share twitter" aria-label="Share with Twitter" rel="nofollow noopener noreferrer"><svg><use xlink:href="https://blog.kris-lab.com/assets/svg/svg-map.svg#twitter"/></svg> </a><a href="http://www.linkedin.com/shareArticle?url=https%3A%2F%2Fblog.kris-lab.com%2Fnfs-to-aws-s3-migration-15.html&amp;title=NFS%20to%20AWS%20S3%20migration" class="js-share linkedin" aria-label="Share with LinkedIn" rel="nofollow noopener noreferrer"><svg><use xlink:href="https://blog.kris-lab.com/assets/svg/svg-map.svg#linkedin"/></svg> </a><a href="https://buffer.com/add?text=NFS%20to%20AWS%20S3%20migration&amp;url=https%3A%2F%2Fblog.kris-lab.com%2Fnfs-to-aws-s3-migration-15.html" class="js-share buffer" aria-label="Share with Buffer" rel="nofollow noopener noreferrer"><svg><use xlink:href="https://blog.kris-lab.com/assets/svg/svg-map.svg#buffer"/></svg></a></aside></div><div class="post__bio author"><div><h3 class="h6 author__name"><a href="https://blog.kris-lab.com/authors/chris-stasiak/" class="invert" title="Chris Stasiak">Chris Stasiak</a></h3></div></div><nav class="post__nav"><div class="post__nav__prev"><a class="post__nav__link" href="https://blog.kris-lab.com/reducing-openx-to-revive-adsserver-migration-pain-93.html" rel="prev">Previous Post<h3 class="h6">Reducing OpenX to Revive AdsServer migration pain!</h3></a></div><div class="post__nav__next"><a class="post__nav__link" href="https://blog.kris-lab.com/cgroups-for-simple-resources-isolation-and-management-5.html" rel="prev">Next Post<h3 class="h6">CGroups for simple resources isolation and management</h3></a></div></nav></footer></div></article><div class="comments post__inner" id="comments"><h3 class="h5">Comments</h3><div id="disqus_thread"></div><script>var disqus_config = function () {
                    this.page.url = '';
            		this.page.identifier = '';
                    this.page.title = ' NFS to AWS S3 migration - Chris Stasiak ';
                };
            
                var disqus_loaded = false;
            
                function publiiLoadDisqus() {
                    if(disqus_loaded) {
                        return false;
                    }
            
                    var top = document.getElementById('disqus_thread').offsetTop;
            
                    if (!disqus_loaded && (window.scrollY || window.pageYOffset) + window.innerHeight > top) {
                        disqus_loaded = true;
            
                        (function () {
                            var d = document, s = d.createElement('script');
                            s.src = 'https://blog-kris-lab-com.disqus.com/embed.js';
                            s.setAttribute('data-timestamp', +new Date());
                            (d.head || d.body).appendChild(s);
                        })();
                    }
                }
            
                publiiLoadDisqus();
            
                window.onscroll = function() {
                    publiiLoadDisqus();
                };</script><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript></div></div><div class="post__related"><div class="wrapper"><h3 class="h5">Related posts</h3><div class="l-grid l-grid--4"><article class="c-card"><div class="c-card__wrapper"><header class="c-card__header"><div class="c-card__tag"><a href="https://blog.kris-lab.com/tips/">tips</a></div><h2 class="c-card__title"><a href="https://blog.kris-lab.com/reducing-openx-to-revive-adsserver-migration-pain-93.html" class="invert">Reducing OpenX to Revive AdsServer migration pain!</a></h2></header><footer class="c-card__meta"><time datetime="2014-04-06T10:37">April 6, 2014</time><div class="c-card__comments"><svg aria-hidden="true"><title>Comments</title><use xlink:href="https://blog.kris-lab.com/assets/svg/svg-map.svg#comments"/></svg> <a href="https://blog.kris-lab.com/reducing-openx-to-revive-adsserver-migration-pain-93.html#post-comments" data-disqus-identifier="843" class="invert" rel="nofollow">0</a></div></footer></div></article><article class="c-card"><div class="c-card__wrapper"><header class="c-card__header"><div class="c-card__tag"><a href="https://blog.kris-lab.com/devops-2/">devops</a></div><h2 class="c-card__title"><a href="https://blog.kris-lab.com/migration-to-heroku-app-cloud-with-uptimerobot-monitoring-9.html" class="invert">Migration to Heroku App Cloud with UptimeRobot monitoring</a></h2></header><footer class="c-card__meta"><time datetime="2014-03-08T12:19">March 8, 2014</time><div class="c-card__comments"><svg aria-hidden="true"><title>Comments</title><use xlink:href="https://blog.kris-lab.com/assets/svg/svg-map.svg#comments"/></svg> <a href="https://blog.kris-lab.com/migration-to-heroku-app-cloud-with-uptimerobot-monitoring-9.html#post-comments" data-disqus-identifier="841" class="invert" rel="nofollow">0</a></div></footer></div></article></div></div></div></main><footer class="footer"><div class="footer__social"><a href="https://twitter.com/_krislab" aria-label="Twitter" class="twitter"><svg><use xlink:href="https://blog.kris-lab.com/assets/svg/svg-map.svg#twitter"/></svg> </a><a href="https://www.instagram.com/_krislab" aria-label="Instagram" class="instagram"><svg><use xlink:href="https://blog.kris-lab.com/assets/svg/svg-map.svg#instagram"/></svg> </a><a href="https://www.linkedin.com/in/krzysztof-chris-stasiak-6261244b/" aria-label="LinkedIn" class="linkedin"><svg><use xlink:href="https://blog.kris-lab.com/assets/svg/svg-map.svg#linkedin"/></svg></a></div><div class="footer__copyright">&copy; 2020 Powered by Publii Static CMS</div></footer><script>window.publiiThemeMenuConfig = {    
      mobileMenuMode: 'sidebar',
      animationSpeed: 300,
      submenuWidth: 'auto',
      doubleClickTime: 500,
      mobileMenuExpandableSubmenus: true, 
      relatedContainerForOverlayMenuSelector: '.navbar',
   };</script><script defer="defer" src="https://blog.kris-lab.com/assets/js/scripts.min.js?v=8b3e67b51e8c7a7d51b33f4a94ae4287"></script><script>var images = document.querySelectorAll('img[loading]');

      for (var i = 0; i < images.length; i++) {
         if (images[i].complete) {
               images[i].classList.add('is-loaded');
         } else {
               images[i].addEventListener('load', function () {
                  this.classList.add('is-loaded');
               }, false);
         }
      }</script><script id="dsq-count-scr" src="https://blog-kris-lab-com.disqus.com/count.js" async></script></body></html>